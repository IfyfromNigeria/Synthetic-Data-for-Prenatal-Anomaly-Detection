# Synthetic Data for Prenatal Anomaly Detection

This repository contains the code, experiments, and pretrained models from my MSc thesis on **using synthetic data to improve prenatal ultrasound anomaly detection**.  
The project explores classifiers trained on real, synthetic, and hybrid datasets, as well as a conditional WGAN-GP for ultrasound ROI synthesis.

---

## üéØ Project Overview
Prenatal anomaly detection via ultrasound can be challenging due to the limited availability of labeled clinical images.  
This work investigates whether **synthetic data generated by GANs** can help build more robust classifiers:

- **Classifier Models (EfficientNet-B0):**
  - **Real-only**: trained only on clinical ultrasound NT (nuchal translucency) images
  - **Synthetic-only**: trained only on WGAN-GP generated NT images
  - **Hybrid**: trained on a 50/50 mix of real and synthetic images
- **Generator Model (WGAN-GP):**
  - Conditional Wasserstein GAN with Gradient Penalty
  - Generates NT ultrasound patches conditioned on anomaly class

---

## üìä Key Results
- **Hybrid classifier** ‚Äî Best overall (Acc **0.95**, F1 **0.94**, AUC **0.99**, Recall **1.0**)  
- **Real-only classifier** ‚Äî Highest precision (**0.95**) but lower recall (**0.80**)  
- **Synthetic-only classifier** ‚Äî Very high recall (**0.94**) but lower precision (**0.63**)  
- **WGAN-GP** ‚Äî Produced realistic NT textures with reduced mode collapse

üëâ Takeaway: **Synthetic data can complement real medical imaging data**, improving recall without sacrificing overall performance.

---

## üóÇ Repository Structure
src/ # Core Python package

configs/ # YAML configs (training, evaluation, generation)

scripts/ # Helper scripts (e.g., data download)

notebooks/ # Experiment & evaluation notebooks

models/model_cards/ # Model documentation (with links & checksums)

data/README.md # Dataset description and link to dataset (no raw data included)


---

## ‚öôÔ∏è Installation

Clone the repo and install requirements:

```bash
git clone https://github.com/IfyfromNigeria/Synthetic-Data-for-Prenatal-Anomaly-Detection.git
cd Synthetic-Data-for-Prenatal-Anomaly-Detection
pip install -r requirements.txt
```

Dependencies include: PyTorch, Torchvision, EfficientNet-PyTorch, Albumentations, Scikit-learn, OpenCV, Matplotlib, Jupyter.

## üöÄ **Usage**

This project is fully config-driven. All experiment settings (data paths, training hyperparameters, checkpoints, etc.) are defined in YAML files under `configs/`.

### Training

Edit `configs/default.yaml` to set train/val CSVs and checkpoint directory, then run:

```bash
python scripts/train_classifier.py --config configs/default.yaml

```

**Evaluation**

Edit configs/eval.yaml (set test CSV and checkpoint path) and run:

```bash
python scripts/eval_classifier.py --config configs/eval.yaml
```
This will output accuracy, F1, AUC, a confusion matrix (confusion_matrix.png), and a JSON file with metrics.

**Synthetic Data Generation**

WGAN-GP:
To generate synthetic ultrasound patches with the WGAN-GP, use the generator section of configs/eval.yaml (or create a separate config), then run:

```bash
python scripts/generate_synthetic.py --config configs/eval.yaml

```
Images will be saved under the directory specified in the config (generator.output_dir).

## üì• **Pretrained Models**
Pretrained weights are hosted under GitHub Releases.

See models/model_cards for details and checksums:

- Hybrid Classifier (best)

- Real-only Classifier

- Synthetic-only Classifier

- WGAN-GP Generator

## üìë Datasets
- Real data: Dataset for Fetal Framework (licensed access, not redistributed here)

- Synthetic data: Generated using the WGAN-GP in this repo

- For reproducibility: see data/README.md for instructions on obtaining datasets

## üßë‚Äçüíª  **Technical Highlights**
- Deep Learning: PyTorch (EfficientNet, GAN training, custom loops)

- Generative Models: WGAN-GP with gradient penalty, class conditioning

- Data Augmentation: Albumentations (flips, rotations, normalization)

- Evaluation: Accuracy, Precision, Recall, F1, AUC; SHA256 checksums for model integrity

- Reproducibility: Config-driven experiments (.yaml), model cards, GitHub Releases

## üìå **Key Skills Demonstrated**
- Building end-to-end ML pipelines (data loading, augmentation, training, evaluation, inference)

- Applying GANs for medical imaging and leveraging synthetic data for low-resource tasks

- Managing a reproducible research repo (configs, model cards, versioning)

- Communicating technical work through professional documentation and code organization

## üìú **Citation**
If you use this code or models, please cite:

```java
@software{akupuome2025_synthetic_prenatal,
  author = {Ifunanya Akupuome},
  title = {Synthetic Data for Prenatal Anomaly Detection},
  year = {2025},
  url = {https://github.com/IfyfromNigeria/Synthetic-Data-for-Prenatal-Anomaly-Detection}
}
```

## üôã **Contact**

Created and maintained by Ifunanya Akupuome

For questions or collaboration: ifunanyaakupuome@gmail.com
